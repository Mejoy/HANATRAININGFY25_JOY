FUNCTION "HANA_TRAINING.functions::TF_GET_COUNT_RESOURCES" ()
RETURNS TABLE (MANAGERNAME NVARCHAR(50), SAPNO INTEGER )

LANGUAGE SQLSCRIPT AS

BEGIN

RETURN SELECT t2.FIRSTNAME || ' ' || LASTNAME AS MANAGERNAME,
COUNT (t1.SAPNO) AS SAPNO
FROM "HANA_TRAINING.data::PROJECT" t1
INNER JOIN "HANA_TRAINING.data::MANAGER" t2
ON t1.MANAGERSAPNO = t2.SAPNO 
WHERE t1.DELETEFLAG = '0' GROUP BY t2.FIRSTNAME,t2.LASTNAME;

END;  